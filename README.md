# ![icon](./Resource/32x32.png) TwoMiceVD


2台の物理マウスで仮想デスクトップを自動切り替えするWindows 11アプリケーション

## 概要

TwoMiceVDは、Windows 11の仮想デスクトップ機能と組み合わせて使用するユーティリティです。2台の物理マウスを個別に識別し、それぞれのマウスの動きに連動して自動的に仮想デスクトップを切り替えます。

### 主な機能

- **個別マウス識別**: Raw Input APIを使用して複数のマウスを個別に識別
- **自動デスクトップ切り替え**: 各マウスに割り当てられた仮想デスクトップへ自動切り替え
- **接続状態で自動一時停止**: 設定済み2台のうち接続中が1台になった場合にバルーン表示＋自動切り替えを一時停止（2台に戻ると自動再開）
- **システムトレイ常駐**: 軽量なバックグラウンド動作
- **感度調整**: 移動閾値とクールダウン時間の調整可能
- **自動起動**: Windows起動時の自動実行設定

## 必要要件

- Windows 11 22H2以降
- .NET 8.0 SDK
- 物理マウス2台

## セットアップ

### 1. NuGetパッケージの復元

```bash
dotnet restore
```

**必要なパッケージ:**
- `H.InputSimulator` (1.5.0) - 仮想デスクトップ切り替え用（WindowsInput名前空間互換）
- `Newtonsoft.Json` (13.0.3) - 設定ファイル管理用

> **注意**: これらのパッケージはGitHubリポジトリには含まれません。上記コマンドで自動取得されます。

### 2. ビルド

```bash
# リリースビルド（推奨）
dotnet build -c Release

# デバッグビルド
dotnet build -c Debug
```

### 3. 実行ファイルの場所

```
bin\Release\net8.0-windows\TwoMiceVD.exe
```

## 使用方法

1. **アプリケーション起動**
   - ビルドした実行ファイルを起動
   - システムトレイにTwoMiceVDアイコンが表示

2. **マウスペアリング**
   - システムトレイアイコンを右クリック
   - 「ペアリング開始」を選択
   - 画面の指示に従って各マウスを順番に動かす

3. **設定調整**
   - システムトレイアイコンを右クリック
   - 「設定」から感度やクールダウン時間を調整

4. **自動起動設定**
   - システムトレイメニューから「起動時に自動開始」をチェック

## プロジェクト構造

詳細なプロジェクト構造とアーキテクチャについては、[docs/ProjectTree.md](docs/ProjectTree.md)を参照してください。

## トラブルシューティング

### ビルドエラーが発生する場合
- .NET 8.0 SDKがインストールされているか確認
- `dotnet restore`でパッケージが正しく復元されているか確認

### マウスが認識されない場合
- 両方のマウスが物理的に接続されているか確認
- 管理者権限で実行してみる
- ペアリング手順を再度実行

### 仮想デスクトップが切り替わらない場合
- Windows 11で仮想デスクトップ機能が有効か確認
- 設定画面で感度を調整
